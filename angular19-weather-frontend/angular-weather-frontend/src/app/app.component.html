<main class="main">
  <div class="content">
    <h1>Angular 19 Weather App</h1>
    <h2 class="subtitle">
      Fetch Live Weather Data
    </h2>

    <div class="weather-form-row">
      <!-- City Search -->
      <div class="weather-form-section">
        <form #cityForm="ngForm" (ngSubmit)="fetchWeatherByCity()" autocomplete="off">
          <div class="input-row">
            <input
              type="text"
              name="city"
              [(ngModel)]="city"
              placeholder="City Name"
              class="weather-input"
              required
              pattern="^[a-zA-Z\s\-]+$"
              #cityInput="ngModel"
              (keydown.enter)="fetchWeatherByCity()"
            />
          </div>
          <div *ngIf="cityInput.invalid && (cityInput.dirty || cityInput.touched)" class="error-msg">
            <span *ngIf="cityInput.errors?.['required']">City name is required.</span>
          </div>
          <div *ngIf="cityInput.invalid && cityInput.errors?.['pattern'] && (cityInput.dirty || cityInput.touched)" class="error-msg">
            Only letters, spaces, and hyphens are allowed.
          </div>
          <button [disabled]="cityInput.invalid" class="weather-btn">
            Fetch by City
          </button>
        </form>
      </div>

      <div class="weather-divider"></div>

      <!-- Lat / Lon Search -->
      <div class="weather-form-section">
        <div class="input-row">
          <input
            type="number"
            [(ngModel)]="latitude"
            placeholder="Latitude"
            step="any"
            class="weather-input"
            (keydown.enter)="fetchWeatherByLatLon()"
          />
          <input
            type="number"
            [(ngModel)]="longitude"
            placeholder="Longitude"
            step="any"
            class="weather-input"
            (keydown.enter)="fetchWeatherByLatLon()"
          />
        </div>
        <button (click)="fetchWeatherByLatLon()" class="weather-btn">
          Fetch by Latitude/Longitude
        </button>
      </div>
    </div>

    <div *ngIf="errorMsg" class="error-msg">{{ errorMsg }}</div>

    <div *ngIf="weather" class="weather-result">
      <h3>
        Current Weather of
        <span *ngIf="weather.city">{{ weather.city }}</span>
        <span *ngIf="!weather.city">
          ({{ weather.latitude }}, {{ weather.longitude }})
        </span>
      </h3>
      <p><strong>🌍 Latitude:</strong> {{ weather.latitude }}</p>
      <p><strong>🌏 Longitude:</strong> {{ weather.longitude }}</p>
      <p><strong>🌡️ Temperature:</strong> {{ weather.current_weather?.temperature }} °C</p>
      <p><strong>💨 Windspeed:</strong> {{ weather.current_weather?.windspeed }} km/h</p>
      <p><strong>🧭 Wind Direction:</strong> {{ weather.current_weather?.winddirection }}°</p>
      <p><strong>⏰ Time:</strong> {{ weather.current_weather?.time | date:'medium' }}</p>
      <p><strong>🌦️ Weather Code:</strong> {{ weather.current_weather?.weathercode }}</p>
    </div>
  </div>
</main>
<router-outlet />
